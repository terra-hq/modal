(function(o,r){typeof exports=="object"&&typeof module<"u"?module.exports=r():typeof define=="function"&&define.amd?define(r):(o=typeof globalThis<"u"?globalThis:o||self,o.Modal=r())})(this,function(){"use strict";class o{constructor(e={}){const i={selector:".c--modal-a",onShow:s=>{e.debug&&console.info(`${s.id} is shown`)},onClose:s=>{e.debug&&console.info(`${s.id} is hidden`)},beforeOpen:s=>{e.debug&&console.info(`${s.id} is hidden`)},beforeClose:s=>{},openTrigger:"data-modal-open",closeTrigger:"data-modal-close",openClass:"c--modal-a--is-open",disableScroll:!0,debug:!1};this.settings={...i,...e},this.DOM={modals:document.querySelectorAll(this.settings.selector),openTriggers:document.querySelectorAll(`[${this.settings.openTrigger}]`),closeTriggers:document.querySelectorAll(`[${this.settings.closeTrigger}]`)},this.eventListeners=[],this.init(),this.events()}logDebug(e){this.settings.debug&&console.debug(`[Modal Debug]: ${e}`)}init(){if(this.DOM.modals.length===0){console.error(`No modals found with selector "${this.settings.selector}".`);return}this.logDebug(`Found ${this.DOM.modals.length} modals with selector "${this.settings.selector}".`)}events(){this.DOM.modals.forEach(e=>this.addEventListeners(e))}addEventListeners(e){const i=e.id;this.DOM.openTriggers.forEach(t=>{if(t.getAttribute(this.settings.openTrigger)===i){const n=c=>{var l;c.preventDefault();const d={type:"element",element:t,tagName:t.tagName.toLowerCase(),text:((l=t.textContent)==null?void 0:l.trim())||"",id:t.id||null};this.open(e,d)};t.addEventListener("click",n),this.eventListeners.push({element:t,type:"click",listener:n})}}),e.querySelectorAll(`[${this.settings.closeTrigger}]`).forEach(t=>{const n=c=>{var l;c.preventDefault(),this.logDebug(`Close trigger clicked for modal ID: ${i}`);const d={type:"element",element:t,tagName:t.tagName.toLowerCase(),text:((l=t.textContent)==null?void 0:l.trim())||"",id:t.id||null,action:"close"};this.close(e,d)};t.addEventListener("click",n),this.eventListeners.push({element:t,type:"click",listener:n})});const s=t=>{if(t.target===e.querySelector(`${this.settings.selector}__overlay`)){this.logDebug(`Overlay clicked for modal ID: ${i}`);const n={type:"overlay",element:t.target,action:"close"};this.close(e,n)}};e.addEventListener("click",s),this.eventListeners.push({element:e,type:"click",listener:s});const a=t=>{if(t.key==="Escape"&&this.isOpen(e)){this.logDebug(`Escape key pressed for modal ID: ${i}`);const n={type:"keyboard",key:t.key,action:"close"};this.close(e,n)}};document.addEventListener("keydown",a),this.eventListeners.push({element:document,type:"keydown",listener:a})}open(e,i=null){const s=i||{type:"programmatic",source:"manual",method:"open()"};typeof this.settings.beforeOpen=="function"&&this.settings.beforeOpen(e,s),this.logDebug(`Opening modal ID: ${e.id}`),e.classList.add(this.settings.openClass),e.setAttribute("aria-hidden","false"),this.settings.disableScroll&&(document.body.style.overflow="hidden"),typeof this.settings.onShow=="function"&&this.settings.onShow(e,s)}async close(e,i=null){const s=i||{type:"programmatic",source:"manual",method:"close()",action:"close"};typeof this.settings.beforeClose=="function"&&await this.settings.beforeClose(e,s),this.logDebug(`Closing modal ID: ${e.id}`),e.classList.remove(this.settings.openClass),e.setAttribute("aria-hidden","true"),this.settings.disableScroll&&(document.body.style.overflow=""),typeof this.settings.onClose=="function"&&this.settings.onClose(e,s)}isOpen(e){return e.classList.contains(this.settings.openClass)}destroy(){this.logDebug("Destroying all event listeners."),this.eventListeners.forEach(({element:e,type:i,listener:s})=>{e.removeEventListener(i,s)}),this.eventListeners=[],console.info("All modal event listeners have been removed.")}}return o});
